<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ page.title }} | Fantasy Map</title>
    <link rel="stylesheet" href="{{ '/assets/theme.css' | relative_url }}">
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif; line-height: 1.6; margin: 0 auto; max-width: 800px; padding: 2em; }
        .back-link { margin-top: 2em; display: inline-block; }
    </style>
</head>
<body>
    <main>
        
        {{ content }}

        <a href="/" class="back-link">&larr; Back to Map</a>
    </main>
</body>
</html> -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ page.title }} | Fantasy Map</title>
    <link rel="stylesheet" href="{{ '/assets/theme.css' | relative_url }}">
    <script>
        // This script runs first to prevent a "flash" of the wrong theme.
        (function() {
            const theme = localStorage.getItem('theme');
            if (theme === 'dark') {
                document.documentElement.classList.add('dark-mode');
            } else {
                // Default to light mode if nothing is set
                document.documentElement.classList.add('light-mode');
            }
        })();
    </script>
</head>
<body>

    <div class="theme-switch-wrapper">
        <label class="theme-switch" for="checkbox">
            <input type="checkbox" id="checkbox" />
            <div class="slider round"></div>
        </label>
    </div>

    <main>
        {{ content }}
        <a href="/" class="back-link">&larr; Back to Map</a>
    </main>

    <script>
        // --- Dark Mode Logic ---
        const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');
        const currentTheme = localStorage.getItem('theme');

        if (currentTheme === 'dark') {
            toggleSwitch.checked = true;
        }

        function switchTheme(e) {
            if (e.target.checked) {
                document.documentElement.classList.replace('light-mode', 'dark-mode');
                localStorage.setItem('theme', 'dark');
            } else {
                document.documentElement.classList.replace('dark-mode', 'light-mode');
                localStorage.setItem('theme', 'light');
            }
        }

        toggleSwitch.addEventListener('change', switchTheme, false);
    </script>

</body>
</html>
